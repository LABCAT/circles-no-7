{"version":3,"sources":["js/helpers/Globals.js","js/functions/PlayIcon.js","audio/circles-no-7.ogg","audio/circles-no-7.mid","audio/circles-no-7-remix.ogg","audio/circles-no-7-remix.mid","js/P5SketchWithAudio.js","js/App.js","index.js"],"names":["window","p5","PlayIcon","_jsxs","id","className","xmlns","height","viewBox","width","children","_jsx","d","fill","P5SketchWithAudio","sketchRef","useRef","Sketch","p","canvas","canvasWidth","innerWidth","canvasHeight","innerHeight","audioLoaded","player","PPQ","playRemix","loadMidi","midiFile","midiRemix","midi","Midi","fromUrl","then","result","noteSet1","tracks","notes","scheduleCueSet","document","getElementById","classList","add","remove","preload","Math","random","audioFile","audioRemix","audio","song","loadSound","onended","logCredits","noteSet","callbackName","poly","arguments","length","undefined","lastTicks","currentCue","i","note","ticks","time","addCue","setup","createCanvas","background","colorMode","HSB","strokeWeight","noLoop","draw","translate","isPlaying","circleSets","executeCueSet1","duration","circleSize","stepsIncrementer","ceil","TWO_PI","acos","x","y","numOfSteps","numOfRings","rotation","size","array","j","push","shuffle","console","log","flat","delay","drawCircleSpiral","isFlat","reverse","hue","_loop","_p$circleSets$i","setTimeout","stroke","rotate","circle","_loop2","circlesArray","_circlesArray$j","hasStarted","mousePressed","pause","parseInt","currentTime","buffer","reset","dataLayer","title","location","href","addClass","play","creditsLogged","stop","updateCanvasDimensions","resizeCanvas","attachEvent","addEventListener","useEffect","current","ref","App","ReactDOM","render","React","StrictMode"],"mappings":"kMAGAA,OAAOC,GAAKA,E,yBCHG,SAASC,IACpB,OACIC,eAAA,OAAKC,GAAG,YAAYC,UAAU,WAAWC,MAAM,6BAA6BC,OAAO,KAAKC,QAAQ,YAAYC,MAAM,KAAIC,SAAA,CAClHC,cAAA,QAAMC,EAAE,gBAAgBC,KAAK,SAC7BF,cAAA,QAAMC,EAAE,2JCJL,UAA0B,yCCA1B,MAA0B,yCCA1B,MAA0B,+CCA1B,MAA0B,+CC0R1BE,EA1QW,WACtB,IAAMC,EAAYC,mBAEZC,EAAS,SAAAC,GAEXA,EAAEC,OAAS,KAEXD,EAAEE,YAAcpB,OAAOqB,WAEvBH,EAAEI,aAAetB,OAAOuB,YAExBL,EAAEM,aAAc,EAEhBN,EAAEO,OAAS,KAEXP,EAAEQ,IAAM,MAERR,EAAES,WAAY,EAEdT,EAAEU,SAAW,WACT,IAAMC,EAAWX,EAAES,UAAYG,EAAYC,EAC3CC,OAAKC,QAAQJ,GAAUK,MACnB,SAASC,GACL,IAAMC,EAAWD,EAAOE,OAAO,GAAGC,MAClCpB,EAAEqB,eAAeH,EAAU,kBAC3BlB,EAAEM,aAAc,EAChBgB,SAASC,eAAe,UAAUC,UAAUC,IAAI,qBAChDH,SAASC,eAAe,aAAaC,UAAUE,OAAO,gBAMlE1B,EAAE2B,QAAU,WACR3B,EAAES,UAAYmB,KAAKC,SAAW,GAC9B,IAAMC,EAAY9B,EAAES,UAAYsB,EAAaC,EAC7ChC,EAAEiC,KAAOjC,EAAEkC,UAAUJ,EAAW9B,EAAEU,UAClCV,EAAEiC,KAAKE,QAAQnC,EAAEoC,aAGrBpC,EAAEqB,eAAiB,SAACgB,EAASC,GAGzB,IAH0D,IAAnBC,EAAIC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACvCG,GAAa,EACbC,EAAa,EACRC,EAAI,EAAGA,EAAIR,EAAQI,OAAQI,IAAK,CAC/B,IAAAC,EAAOT,EAAQQ,GACfE,EAAgBD,EAAhBC,MAAOC,EAASF,EAATE,MACVD,IAAUJ,GAAaJ,KACtBO,EAAKF,WAAaA,EAClB5C,EAAEiC,KAAKgB,OAAOD,EAAMhD,EAAEsC,GAAeQ,GACrCH,EAAYI,EACZH,OAKZ5C,EAAEkD,MAAQ,WACNlD,EAAEC,OAASD,EAAEmD,aAAanD,EAAEE,YAAaF,EAAEI,cAC3CJ,EAAEoD,WAAW,GACbpD,EAAEqD,UAAUrD,EAAEsD,KACdtD,EAAEuD,aAAa,GACfvD,EAAEwD,UAINxD,EAAEyD,KAAO,WACLzD,EAAE0D,UAAU1D,EAAET,MAAM,EAAGS,EAAEX,OAAO,GAC7BW,EAAEM,aAAeN,EAAEiC,KAAK0B,aAK/B3D,EAAE4D,WAAa,GAEf5D,EAAE6D,eAAiB,SAACf,GAChB,IAAQF,EAAyBE,EAAzBF,WAAYkB,EAAahB,EAAbgB,SACdC,EAAa/D,EAAE6B,OAAO,GAAI,KAC5BmC,EAAmBpC,KAAKqC,KAAKjE,EAAEkE,OAAStC,KAAKuC,KAAK,IAAO,EAAIJ,GAAc,EAAIA,MAC/EK,EAAI,EACJC,EAAI,EACJC,EAAaN,EACbO,EAAavE,EAAET,MAAQ,GAAKS,EAAEX,OAAS,EACvCuC,KAAKqC,KAAMjE,EAAET,MAAQ,EAAKwE,GAC1BnC,KAAKqC,KAAMjE,EAAEX,OAAS,EAAK0E,GAE/B/D,EAAE4D,WAAa,GACf5D,EAAE4D,WAAW,GAAK,CACd,CACIY,SAAU,EACVJ,EAAG,EACHC,EAAG,EACHI,KAAMV,IAKdM,EADAD,GAAQL,EAGR,IAAK,IAAIlB,EAAI,EAAGA,EAAI0B,EAAY1B,IAAK,CAEjC,IADA,IAAM6B,EAAQ,GACLC,EAAI,EAAGA,EAAIL,EAAYK,IAC5BD,EAAME,KACF,CACIJ,SAAUxE,EAAEkE,OAAOI,EACnBF,EAAGA,EACHC,EAAGA,EACHI,KAAMV,IAIlB/D,EAAE4D,WAAWf,GAAK7C,EAAE6E,QAAQH,GAE5BL,EADAD,GAAQL,EAERO,GAA0BN,EAG9Bc,QAAQC,IAAInC,GACM,KAAfA,IACC5C,EAAE4D,WAAa5D,EAAE4D,WAAWoB,QAEhC,IACMC,EAAoB,IAAXnB,GADwB,KAAflB,EAAoB5C,EAAE4D,WAAWnB,OAAS,GAElEzC,EAAEkF,iBAAiBD,EAAsB,KAAfrC,IAG9B5C,EAAEkF,iBAAmB,SAACD,EAAOE,GACtBvD,KAAKC,SAAW,IACf7B,EAAE4D,WAAWwB,UAGjB,IAAMC,EAAMrF,EAAE6B,OAAO,EAAG,KAExB,GADA7B,EAAEoD,WAAWiC,EAAK,GAAI,IACnBF,EACC,IADQ,IAADG,EAAA,SACEzC,GACL,IAAA0C,EAAiCvF,EAAE4D,WAAWf,GAAtC2B,EAAQe,EAARf,SAAUJ,EAACmB,EAADnB,EAAGC,EAACkB,EAADlB,EAAGI,EAAIc,EAAJd,KACxBe,YACI,WACIxF,EAAEL,KAAK0F,EAAKrF,EAAE6B,OAAO,GAAI,KAAM7B,EAAE6B,OAAO,GAAI,MAC5C7B,EAAEyF,OAAOJ,EAAKrF,EAAE6B,OAAO,GAAI,KAAM7B,EAAE6B,OAAO,GAAI,MAC9C7B,EAAE0F,OAAOlB,GACTxE,EAAE2F,OAAOvB,EAAGC,EAAGI,EAAMA,KAExBQ,EAAQpC,IATRA,EAAI,EAAGA,EAAI7C,EAAE4D,WAAWnB,OAAQI,IAAKyC,EAArCzC,QAcT,IADE,IAAD+C,EAAA,SACQ/C,GACL,IAAMgD,EAAe7F,EAAE4D,WAAWf,GAClC2C,YACI,WACI,IAAK,IAAIb,EAAI,EAAGA,EAAIkB,EAAapD,OAAQkC,IAAK,CAC1C,IAAAmB,EAAiCD,EAAalB,GAAtCH,EAAQsB,EAARtB,SAAUJ,EAAC0B,EAAD1B,EAAGC,EAACyB,EAADzB,EAAGI,EAAIqB,EAAJrB,KACxBzE,EAAEL,KAAK0F,EAAKrF,EAAE6B,OAAO,GAAI,KAAM7B,EAAE6B,OAAO,GAAI,MAC5C7B,EAAEyF,OAAOJ,EAAKrF,EAAE6B,OAAO,GAAI,KAAM7B,EAAE6B,OAAO,GAAI,MAC9C7B,EAAE0F,OAAOlB,GACTxE,EAAE2F,OAAOvB,EAAGC,EAAGI,EAAMA,MAG5BQ,EAAQpC,IAZRA,EAAI,EAAGA,EAAI7C,EAAE4D,WAAWnB,OAAQI,IAAK+C,EAArC/C,IAkBjB7C,EAAE+F,YAAa,EAEf/F,EAAEgG,aAAe,WACVhG,EAAEM,cACGN,EAAEiC,KAAK0B,YACP3D,EAAEiC,KAAKgE,SAEHC,SAASlG,EAAEiC,KAAKkE,gBAAkBD,SAASlG,EAAEiC,KAAKmE,OAAOtC,YACzD9D,EAAEqG,QAC8B,qBAArBvH,OAAOwH,WACdxH,OAAOwH,UAAU1B,KACb,CACI,MAAS,iBACT,UAAa,CACT,MAAStD,SAASiF,MAClB,SAAYzH,OAAO0H,SAASC,KAC5B,OAAU,gBAM9BnF,SAASC,eAAe,aAAaC,UAAUC,IAAI,YACnDzB,EAAEC,OAAOyG,SAAS,WAClB1G,EAAEiC,KAAK0E,OACyB,qBAArB7H,OAAOwH,WAAmCtG,EAAE+F,aACnDjH,OAAOwH,UAAU1B,KACb,CACI,MAAS,iBACT,UAAa,CACT,MAAStD,SAASiF,MAClB,SAAYzH,OAAO0H,SAASC,KAC5B,OAAU,mBAItBzG,EAAE+F,YAAa,MAM/B/F,EAAE4G,eAAgB,EAElB5G,EAAEoC,WAAa,YAENpC,EAAE4G,eACHV,SAASlG,EAAEiC,KAAKkE,gBAAkBD,SAASlG,EAAEiC,KAAKmE,OAAOtC,YAEzD9D,EAAE4G,eAAgB,EACd9B,QAAQC,IACR,8BACA,KACA,4CAEJ/E,EAAEiC,KAAK4E,SAIf7G,EAAEqG,MAAQ,aAIVrG,EAAE8G,uBAAyB,WACvB9G,EAAEE,YAAcpB,OAAOqB,WACvBH,EAAEI,aAAetB,OAAOuB,YACxBL,EAAEC,OAASD,EAAE+G,aAAa/G,EAAEE,YAAaF,EAAEI,eAG3CtB,OAAOkI,YACPlI,OAAOkI,YACH,YACA,WACIhH,EAAE8G,4BAILhI,OAAOmI,kBACZnI,OAAOmI,iBACH,UACA,WACIjH,EAAE8G,4BAEN,IAYZ,OAJAI,qBAAU,WACN,IAAInI,EAAGgB,EAAQF,EAAUsH,WAC1B,IAGC1H,cAAA,OAAK2H,IAAKvH,EAAUL,SAChBC,cAACT,EAAQ,OC7QNqI,MANf,WACE,OACE5H,cAACG,EAAiB,KCCtB0H,IAASC,OACP9H,cAAC+H,IAAMC,WAAU,CAAAjI,SACfC,cAAC4H,EAAG,MAEN/F,SAASC,eAAe,W","file":"static/js/main.f78f0cd3.chunk.js","sourcesContent":["// p5.sound doesn't work correctly when p5 is not available in the global name space so we add it here\n// https://github.com/processing/p5.js-sound/issues/512\nimport * as p5 from \"p5\";\nwindow.p5 = p5;\n","export default function PlayIcon() {\n    return (\n        <svg id=\"play-icon\" className='fade-out' xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" />\n        </svg>\n    )\n}\n","export default __webpack_public_path__ + \"static/media/circles-no-7.15cc6d35.ogg\";","export default __webpack_public_path__ + \"static/media/circles-no-7.0e6df8b6.mid\";","export default __webpack_public_path__ + \"static/media/circles-no-7-remix.01c7fbe1.ogg\";","export default __webpack_public_path__ + \"static/media/circles-no-7-remix.ff2fcc35.mid\";","import React, { useRef, useEffect } from \"react\";\nimport \"./helpers/Globals\";\nimport \"p5/lib/addons/p5.sound\";\nimport * as p5 from \"p5\";\nimport { Midi } from '@tonejs/midi'\nimport PlayIcon from './functions/PlayIcon.js';\n\nimport audio from \"../audio/circles-no-7.ogg\";\nimport midi from \"../audio/circles-no-7.mid\";\n\nimport audioRemix from \"../audio/circles-no-7-remix.ogg\";\nimport midiRemix from \"../audio/circles-no-7-remix.mid\";\n\n/**\n * Circles No. 7\n */\nconst P5SketchWithAudio = () => {\n    const sketchRef = useRef();\n\n    const Sketch = p => {\n\n        p.canvas = null;\n\n        p.canvasWidth = window.innerWidth;\n\n        p.canvasHeight = window.innerHeight;\n\n        p.audioLoaded = false;\n\n        p.player = null;\n\n        p.PPQ = 3840 * 4;\n\n        p.playRemix = true;\n\n        p.loadMidi = () => {\n            const midiFile = p.playRemix ? midiRemix : midi; \n            Midi.fromUrl(midiFile).then(\n                function(result) {\n                    const noteSet1 = result.tracks[2].notes; // Synth 1 - Init Patch\n                    p.scheduleCueSet(noteSet1, 'executeCueSet1');\n                    p.audioLoaded = true;\n                    document.getElementById(\"loader\").classList.add(\"loading--complete\");\n                    document.getElementById(\"play-icon\").classList.remove(\"fade-out\");\n                }\n            );\n            \n        }\n\n        p.preload = () => {\n            p.playRemix = Math.random() > 0.4;\n            const audioFile = p.playRemix ? audioRemix : audio; \n            p.song = p.loadSound(audioFile, p.loadMidi);\n            p.song.onended(p.logCredits);\n        }\n\n        p.scheduleCueSet = (noteSet, callbackName, poly = false)  => {\n            let lastTicks = -1,\n                currentCue = 1;\n            for (let i = 0; i < noteSet.length; i++) {\n                const note = noteSet[i],\n                    { ticks, time } = note;\n                if(ticks !== lastTicks || poly){\n                    note.currentCue = currentCue;\n                    p.song.addCue(time, p[callbackName], note);\n                    lastTicks = ticks;\n                    currentCue++;\n                }\n            }\n        } \n\n        p.setup = () => {\n            p.canvas = p.createCanvas(p.canvasWidth, p.canvasHeight);\n            p.background(0);\n            p.colorMode(p.HSB);\n            p.strokeWeight(8);\n            p.noLoop();\n        }\n\n\n        p.draw = () => {\n            p.translate(p.width/2, p.height/2);\n            if(p.audioLoaded && p.song.isPlaying()){\n\n            }\n        }\n\n        p.circleSets = [];\n\n        p.executeCueSet1 = (note) => {\n            const { currentCue, duration } = note;\n            const circleSize = p.random(50, 100);\n            let stepsIncrementer = Math.ceil(p.TWO_PI / Math.acos(0.5 * (1 - circleSize / (2 * circleSize))))\n            let x = 0;\n            let y = 0;\n            let numOfSteps = stepsIncrementer;\n            let numOfRings = p.width / 2 >= p.height / 2 ? \n                Math.ceil((p.width / 2) / circleSize) :\n                Math.ceil((p.height / 2) / circleSize);\n\n            p.circleSets = [];\n            p.circleSets[0] = [\n                {\n                    rotation: 0,\n                    x: 0, \n                    y: 0, \n                    size: circleSize,\n                }\n            ];\n\n            x = x + circleSize;\n            y = x;\n\n            for (let i = 1; i < numOfRings; i++) {\n                const array = [];\n                for (let j = 0; j < numOfSteps; j++){\n                    array.push(\n                        {\n                            rotation: p.TWO_PI/numOfSteps,\n                            x: x, \n                            y: y, \n                            size: circleSize,\n                        }\n                    );\n                }\n                p.circleSets[i] = p.shuffle(array);\n                x = x + circleSize;\n                y = x;\n                numOfSteps = numOfSteps + stepsIncrementer;\n            }\n\n            console.log(currentCue);\n            if(currentCue === 55) {\n                p.circleSets = p.circleSets.flat();\n            }\n            const durationDivisor = currentCue === 55 ? p.circleSets.length : 8;\n            const delay = (duration * 1000 / durationDivisor);\n            p.drawCircleSpiral(delay, currentCue === 55);\n        }\n\n        p.drawCircleSpiral = (delay, isFlat) => {\n            if(Math.random() > 0.5) {\n                p.circleSets.reverse();\n            }\n\n            const hue = p.random(0, 360);\n            p.background(hue, 75, 50);\n            if(isFlat) {\n                for (let i = 0; i < p.circleSets.length; i++) {\n                    const { rotation, x, y, size } = p.circleSets[i];\n                    setTimeout(\n                        function () {\n                            p.fill(hue, p.random(50, 100), p.random(75, 100));\n                            p.stroke(hue, p.random(50, 100), p.random(75, 100));\n                            p.rotate(rotation);\n                            p.circle(x, y, size, size);\n                        },\n                        (delay * i)\n                    );\n                }\n            }\n            else {\n                for (let i = 0; i < p.circleSets.length; i++) {\n                    const circlesArray = p.circleSets[i];\n                    setTimeout(\n                        function () {\n                            for (let j = 0; j < circlesArray.length; j++) {\n                                const { rotation, x, y, size } = circlesArray[j];\n                                p.fill(hue, p.random(50, 100), p.random(75, 100));\n                                p.stroke(hue, p.random(50, 100), p.random(75, 100));\n                                p.rotate(rotation);\n                                p.circle(x, y, size, size);\n                            }\n                        },\n                        (delay * i)\n                    );\n                }\n            }\n        }\n\n        p.hasStarted = false;\n\n        p.mousePressed = () => {\n            if(p.audioLoaded){\n                if (p.song.isPlaying()) {\n                    p.song.pause();\n                } else {\n                    if (parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)) {\n                        p.reset();\n                        if (typeof window.dataLayer !== typeof undefined){\n                            window.dataLayer.push(\n                                { \n                                    'event': 'play-animation',\n                                    'animation': {\n                                        'title': document.title,\n                                        'location': window.location.href,\n                                        'action': 'replaying'\n                                    }\n                                }\n                            );\n                        }\n                    }\n                    document.getElementById(\"play-icon\").classList.add(\"fade-out\");\n                    p.canvas.addClass(\"fade-in\");\n                    p.song.play();\n                    if (typeof window.dataLayer !== typeof undefined && !p.hasStarted){\n                        window.dataLayer.push(\n                            { \n                                'event': 'play-animation',\n                                'animation': {\n                                    'title': document.title,\n                                    'location': window.location.href,\n                                    'action': 'start playing'\n                                }\n                            }\n                        );\n                        p.hasStarted = false\n                    }\n                }\n            }\n        }\n\n        p.creditsLogged = false;\n\n        p.logCredits = () => {\n            if (\n                !p.creditsLogged &&\n                parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)\n            ) {\n                p.creditsLogged = true;\n                    console.log(\n                    \"Music By: http://labcat.nz/\",\n                    \"\\n\",\n                    \"Animation By: https://github.com/LABCAT/\"\n                );\n                p.song.stop();\n            }\n        };\n\n        p.reset = () => {\n\n        }\n\n        p.updateCanvasDimensions = () => {\n            p.canvasWidth = window.innerWidth;\n            p.canvasHeight = window.innerHeight;\n            p.canvas = p.resizeCanvas(p.canvasWidth, p.canvasHeight);\n        }\n\n        if (window.attachEvent) {\n            window.attachEvent(\n                'onresize',\n                function () {\n                    p.updateCanvasDimensions();\n                }\n            );\n        }\n        else if (window.addEventListener) {\n            window.addEventListener(\n                'resize',\n                function () {\n                    p.updateCanvasDimensions();\n                },\n                true\n            );\n        }\n        else {\n            //The browser does not support Javascript event binding\n        }\n    };\n\n    useEffect(() => {\n        new p5(Sketch, sketchRef.current);\n    }, []);\n\n    return (\n        <div ref={sketchRef}>\n            <PlayIcon />\n        </div>\n    );\n};\n\nexport default P5SketchWithAudio;\n","import P5SketchWithAudio from './P5SketchWithAudio'\n\nfunction App() {\n  return (\n    <P5SketchWithAudio/>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/build.css';\nimport App from './js/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}